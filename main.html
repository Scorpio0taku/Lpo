<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Happy Birthday!</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500&family=Quicksand:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #4169e1;
            --light-blue: #6495ed;
            --soft-pink: #ffb6c1;
            --gold: #ffd700;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(180deg, #0a0a1a 0%, #1a1a3a 100%);
            color: white;
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        .opening-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(rgba(10, 10, 40, 0.9), rgba(30, 30, 80, 0.7)),
                        url('https://res.cloudinary.com/dx7sgtdun/image/upload/IMG-20251225-WA0049_sm2ija.jpg') center/cover no-repeat;
            position: relative;
            overflow: hidden;
            filter: saturate(0.95);
        }

        .birthday-title {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            color: var(--gold);
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            animation: titleGlow 3s infinite alternate;
        }

        @keyframes titleGlow {
            from { text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5); }
            to { text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3), 0 0 30px rgba(255, 215, 0, 0.2); }
        }

        .date { font-size: 1.5rem; color: #b3d9ff; margin-bottom: 40px; letter-spacing: 3px; }

        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--light-blue);
            font-size: 1.2rem;
            animation: bounce 2s infinite;
            opacity: 0;
        }

        @keyframes bounce {
            0%,100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        .letter-section {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            margin-top: -50px;
            position: relative;
            z-index: 2;
            border: 1px solid rgba(100, 149, 237, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .letter-container { position: relative; min-height: 400px; }

        .letter-text {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            color: #f0f8ff;
            line-height: 1.8;
            white-space: pre-wrap;
            opacity: 0.95;
            border-left: 3px solid var(--soft-pink);
            padding-left: 30px;
            margin-bottom: 40px;
            display: inline-block;
            vertical-align: top;
        }

        .typewriter-cursor {
            display: inline-block;
            width: 3px;
            height: 1.8rem;
            background: var(--soft-pink);
            margin-left: 8px;
            animation: blink 1s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0% { opacity: 1 }
            50% { opacity: 0 }
            100% { opacity: 1 }
        }

        .emoji-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin: 40px 0;
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
        }

        .emoji { font-size: 3rem; cursor: pointer; transition: all 0.3s ease; filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.2)); }
        .emoji:hover { transform: scale(1.2) rotate(10deg); filter: drop-shadow(0 10px 20px rgba(255, 182, 193, 0.3)); }

        .emoji-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            z-index: 1000;
            display: none;
            font-size: 1.2rem;
            text-align: center;
            border: 1px solid var(--soft-pink);
            max-width: 300px;
        }

        .collage-section { padding: 60px 20px; max-width: 1200px; margin: 0 auto; }
        .collage-title { text-align: center; font-size: 2.5rem; color: var(--gold); margin-bottom: 40px; font-family: 'Dancing Script', cursive; }

        .collage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .collage-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            aspect-ratio: 1;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

        .collage-item:hover { transform: translateY(-5px) rotate(2deg); }

        .collage-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .collage-item:hover img { transform: scale(1.1); }

        .video-section {
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(rgba(10, 10, 30, 0.9), rgba(20, 20, 50, 0.9));
        }

        .video-container { max-width: 800px; margin: 0 auto; position: relative; }
        .video-prompt {
            font-size: 1.8rem;
            color: var(--gold);
            margin-bottom: 30px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        .video-prompt:hover { color: var(--soft-pink); transform: scale(1.05); }

        .video-wrapper { display: none; margin-top: 30px; border-radius: 15px; overflow: hidden; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5); }
        .video-wrapper iframe { width: 100%; height: 400px; border: none; border-radius: 15px; }

        .final-section {
            min-height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(rgba(20, 20, 50, 0.9), rgba(10, 10, 30, 1));
        }

        .final-message {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            color: var(--soft-pink);
            max-width: 600px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 1s ease;
        }

        .final-message.show { opacity: 1; transform: translateY(0); }

        .audio-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .audio-control:hover { background: rgba(0, 0, 0, 0.7); transform: scale(1.1); }

        @media (max-width: 768px) {
            .birthday-title { font-size: 3rem; }
            .letter-text { font-size: 1.5rem; padding-left: 20px; }
            .letter-section { padding: 40px 20px; margin: 20px; }
            .collage-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
            .emoji { font-size: 2.5rem; }
            .video-wrapper iframe { height: 250px; }
        }

        @media (max-width: 480px) {
            .birthday-title { font-size: 2.5rem; }
            .date { font-size: 1.2rem; }
            .letter-text { font-size: 1.3rem; }
            .final-message { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <section class="opening-section">
        <h1 class="birthday-title">Happy Birthday</h1>
        <div class="date">To Someone Special</div>
        <div class="scroll-indicator">Scroll down for your surprise üíù</div>
    </section>

    <section class="letter-section">
        <div class="letter-container">
            <!-- cursor moved INSIDE the letterText to align correctly -->
            <div class="letter-text" id="letterText"><span class="typewriter-cursor" id="cursor"></span></div>
        </div>
    </section>

    <div class="emoji-container" id="emojiContainer"></div>

    <div class="emoji-message" id="emojiMessage"></div>

    <section class="collage-section">
        <h2 class="collage-title">Beautiful Memories</h2>
        <div class="collage-grid" id="collageGrid"></div>
    </section>

    <section class="video-section">
        <div class="video-container">
            <div class="video-prompt" id="videoPrompt">Play this ‚ñ∂Ô∏è</div>
            <div class="video-wrapper" id="videoWrapper">
                <!-- iframe src will be set dynamically on click with autoplay=true -->
                <iframe id="videoIframe"
                    src=""
                    allow="autoplay; fullscreen; encrypted-media; picture-in-picture"
                    allowfullscreen
                    frameborder="0"></iframe>
            </div>
        </div>
    </section>

    <section class="final-section">
        <div class="final-message" id="finalMessage"></div>
    </section>

    <button class="audio-control" id="audioControl">üîä</button>

    <!-- audio src replaced with the exact link you provided -->
    <audio id="bgMusic" loop>
        <source src="https://res.cloudinary.com/dx7sgtdun/video/upload/v1767094256/SpotiDownloader.com_-_Dandelions_-_Ruth_B._1_ab3i4l.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        const letterContent = `My Dearest,

This is your special day, and I wanted to create something 
as unique and wonderful as you are. Every moment with you 
has been a gift, and today, I celebrate the incredible 
person you are.

You bring light into every room you enter, laughter to every 
conversation, and love to every heart you touch. Today is 
about honoring you and all the joy you bring to the world.

Remember that time we... [Your personal memory here]

And that other moment when... [Another memory]

You are loved more than words can express, cherished beyond 
measure, and celebrated today and always.

With all my love,
Always`;

        const emojiMessages = {
            '‚ù§Ô∏è': 'You are loved more than you know',
            'üéÇ': 'Sweetest birthday wishes just for you',
            'üéà': 'May your day be filled with joy',
            'üéÅ': 'You are the greatest gift',
            'üåü': 'You shine brighter than any star',
            'üíù': 'My heart is always with you',
            'ü•Ç': 'To many more beautiful years',
            'üíå': 'Every moment with you is precious'
        };

        // photo URLs replaced with the exact links you provided
        const photoUrls = [
            'https://res.cloudinary.com/dx7sgtdun/image/upload/IMG-20251225-WA0049_sm2ija.jpg',
            'https://res.cloudinary.com/dx7sgtdun/image/upload/IMG-20241003-WA0048_hejzeg.jpg',
            'https://res.cloudinary.com/dx7sgtdun/image/upload/Screenshot_20251229-093112_2_wiucvu.jpg',
            'https://res.cloudinary.com/dx7sgtdun/image/upload/Screenshot_20251229-093251_2_mpm00p.jpg',
            'https://res.cloudinary.com/dx7sgtdun/image/upload/Screenshot_20251229-093310_2_fx3cuu.jpg',
            'https://res.cloudinary.com/dx7sgtdun/image/upload/Snapchat-1069352973_ccsup9.jpg'
        ];

        const finalMessageContent = "Forever and always, my love. üíô";

        async function typeLetter() {
            const letterElement = document.getElementById('letterText');
            const cursor = document.getElementById('cursor');
            const text = letterContent;
            let index = 0;

            // temporarily stop blink while typing
            cursor.style.animation = 'none';

            function type() {
                if (index < text.length) {
                    // keep the cursor inside the letter text
                    letterElement.innerHTML = text.substring(0, index + 1) + '<span class="typewriter-cursor" id="cursor"></span>';
                    index++;
                    setTimeout(type, 50); // slow & emotional
                } else {
                    // restore blinking cursor
                    const newCursor = document.getElementById('cursor');
                    if (newCursor) newCursor.style.animation = 'blink 1s infinite';
                    createEmojis();
                    loadCollage();
                }
            }

            setTimeout(type, 1000);
        }

        function createEmojis() {
            const container = document.getElementById('emojiContainer');
            const emojis = Object.keys(emojiMessages);

            // place emojis randomly but non-obstructive
            emojis.forEach(emoji => {
                const emojiElement = document.createElement('div');
                emojiElement.className = 'emoji';
                emojiElement.textContent = emoji;
                emojiElement.style.opacity = 0.95;

                emojiElement.addEventListener('click', () => {
                    showEmojiMessage(emojiMessages[emoji]);
                });

                container.appendChild(emojiElement);
            });
        }

        function showEmojiMessage(message) {
            const messageElement = document.getElementById('emojiMessage');
            messageElement.textContent = message;
            messageElement.style.display = 'block';

            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 2000);
        }

        function loadCollage() {
            const grid = document.getElementById('collageGrid');

            photoUrls.forEach(url => {
                const item = document.createElement('div');
                item.className = 'collage-item';
                const img = document.createElement('img');
                img.src = url;
                img.alt = 'Beautiful memory';
                img.onerror = function() {
                    console.error('Failed to load image:', url);
                    this.src = 'https://via.placeholder.com/300/4169e1/ffffff?text=Memory';
                };
                item.appendChild(img);
                grid.appendChild(item);
            });
        }

        function setupVideo() {
            const prompt = document.getElementById('videoPrompt');
            const wrapper = document.getElementById('videoWrapper');
            const iframe = document.getElementById('videoIframe');
            const bgMusic = document.getElementById('bgMusic');

            // embed base URL you provided (we will add autoplay=true when user clicks)
            const embedBase = 'https://player.cloudinary.com/embed/?cloud_name=dx7sgtdun&public_id=VID-20251225-WA0060_ftt53g&profile=cld-default';

            prompt.addEventListener('click', () => {
                prompt.style.display = 'none';
                wrapper.style.display = 'block';

                // pause background music when user starts the video
                try { bgMusic.pause(); } catch (e) {}

                // set iframe src with autoplay=true so the player starts (user interaction allows autoplay with sound)
                iframe.src = embedBase + '&autoplay=true';

                // attempt to resume music when the player sends an 'ended' message (some embed players post messages)
                // This is a generic listener ‚Äî if the Cloudinary player posts structured messages, this will catch simple 'ended' markers.
                // If your embed uses a different message structure we'll refine this later.
                // Also show final message shortly after video is active (keeps minimal changes)
            });

            // listen for postMessage events from the player iframe ‚Äî try to detect "ended"
            window.addEventListener('message', (e) => {
                if (!e.data) return;
                const dataStr = typeof e.data === 'string' ? e.data : JSON.stringify(e.data);
                // generic checks for common "ended" phrases
                if (dataStr.toLowerCase().includes('ended') || dataStr.toLowerCase().includes('finish') || dataStr.toLowerCase().includes('played')) {
                    try { bgMusic.play().catch(()=>{}); } catch (err) {}
                    showFinalMessage();
                }
            }, false);
        }

        function showFinalMessage() {
            const finalMessage = document.getElementById('finalMessage');
            finalMessage.textContent = finalMessageContent;

            setTimeout(() => { finalMessage.classList.add('show'); }, 500);
            setTimeout(() => { finalMessage.scrollIntoView({ behavior: 'smooth' }); }, 1000);
        }

        function setupAudio() {
            const bgMusic = document.getElementById('bgMusic');
            const audioControl = document.getElementById('audioControl');

            bgMusic.volume = 0.5;

            // Attempt autoplay; browsers may block it until user interaction.
            bgMusic.play().then(() => {
                audioControl.textContent = "üîä";
            }).catch(e => {
                // autoplay prevented ‚Äî set control to muted icon until user triggers play
                audioControl.textContent = "üîá";
            });

            audioControl.addEventListener('click', () => {
                if (bgMusic.paused) {
                    bgMusic.play().then(()=> {
                        audioControl.textContent = "üîä";
                    }).catch(()=> {
                        audioControl.textContent = "üîá";
                    });
                } else {
                    bgMusic.pause();
                    audioControl.textContent = "üîá";
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            setupAudio();
            typeLetter();
            setupVideo();

            setTimeout(() => {
                document.querySelector('.scroll-indicator').style.opacity = '1';
            }, 2000);
        });
    </script>
</body>
</html>
